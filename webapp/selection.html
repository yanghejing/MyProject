<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>selection</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no" />
    <link rel="stylesheet" href="font/iconfont.css">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/selection.css">
    <link rel="stylesheet" href="lib/echo.css">
</head>

<body>
    <div class="warper">
        <header>
            <div class="home-goods-list">
                <a href="javascript:void(0)"><span>&#xe600;</span></a>
            </div>
            <div class="home-title">
                <span>发现</span>
            </div>
            <div class="home-header-right">
                <div class="search-box">
                    <a href="javascript:void(0)" id="search"><span>&#xe615;</span></a>
                </div>
                <div class="shopping-cat">
                    <a href="my-shop.html"><span>&#xe61b;</span></a>
                </div>
            </div>
        </header>
        <section id="wrapper">
            <div class="spread" id="scroller">
                <nav>
                    <div class="nav">
                        <ul class="clearfix calssify">
                            <li>
                                <a href="javscript:void(0);" data-url='zhuolei'>
                                    <span>&#xe606;</span>
                                    <i>桌类</i>
                                </a>
                            </li>
                            <li>
                                <a href="javscript:void(0);" data-url='zuoju'>
                                    <span>&#xe622;</span>
                                    <i>座具</i>
                                </a>
                            </li>
                            <li>
                                <a href="javscript:void(0);" data-url='guilei'>
                                    <span>&#xe6b6;</span>
                                    <i>柜类</i>
                                </a>
                            </li>
                            <li>
                                <a href="javscript:void(0);" data-url='dengju'>
                                    <span>&#xe64c;</span>
                                    <i>灯具</i>
                                </a>
                            </li>
                            <li>
                                <a href="javscript:void(0);" data-url='chuangju'>
                                    <span>&#xe60a;</span>
                                    <i>床具</i>
                                </a>
                            </li>
                            <li>
                                <a href="javscript:void(0);" data-url='canchu'>
                                    <span>&#xe60f;</span>
                                    <i>餐厨</i>
                                </a>
                            </li>
                            <li>
                                <a href="javscript:void(0);" data-url='jiaju'>
                                    <span>&#xe607;</span>
                                    <i>家居</i>
                                </a>
                            </li>
                            <li class="active">
                                <a href="javascript:void(0)" data-url='other'>
                                    <span>&#xe60b;</span>
                                    <i>其他</i>
                                </a>
                            </li>
                        </ul>
                    </div>
                </nav>
                <ul class="flow clearfix">
                    <li>
                        <dl>
                            <dt>
                                <a href="com-details.html"><img src="./images/s-images/sp6.png" alt=""></a>
                            </dt>
                            <dd>
                                <p>日式进口亚麻餐垫/餐布</p>
                                <a href="javascript:void(0)">
                                    <span>&#xe64f;</span><i>16</i>
                                </a>
                                <a href="javascript:void(0)" class="foc">
                                    <span class="love_a">&#xe639;</span><i class="love_t">19</i>
                                </a>
                            </dd>
                        </dl>
                        <dl>
                            <dt>
                                <a href="com-details.html"><img src="./images/s-images/sp1.png" alt=""></a>
                            </dt>
                            <dd>
                                <p>梵几新高脚L背椅</p>
                                <a href="javascript:void(0)">
                                    <span>&#xe64f;</span><i>24</i>
                                </a>
                                <a href="javascript:void(0)" class="foc">
                                    <span class="love_a">&#xe639;</span><i class="love_t">32</i>
                                </a>
                            </dd>
                        </dl>
                        <dl>
                            <dt>
                                <a href="com-details.html"><img src="./images/s-images/sp2.png" alt=""></a>
                            </dt>
                            <dd>
                                <p>木智工坊蹼椅</p>
                                <a href="javascript:void(0)">
                                    <span>&#xe64f;</span><i>34</i>
                                </a>
                                <a href="javascript:void(0)" class="foc">
                                    <span class="love_a">&#xe639;</span><i class="love_t">63</i>
                                </a>
                            </dd>
                        </dl>
                    </li>
                    <li>
                        <dl>
                            <dt>
                                <a href="com-details.html"><img src="./images/s-images/sp4.png" alt=""></a>
                            </dt>
                            <dd>
                                <p>创意个性餐厅吊灯</p>
                                <a href="javascript:void(0)">
                                    <span>&#xe64f;</span><i>14</i>
                                </a>
                                <a href="javascript:void(0)" class="foc">
                                    <span class="love_a">&#xe639;</span><i class="love_t">26</i>
                                </a>
                            </dd>
                        </dl>
                        <dl>
                            <dt>
                                <a href="com-details.html"><img src="./images/s-images/sp3.png" alt=""></a>
                            </dt>
                            <dd>
                                <p>泰国进口手工勺</p>
                                <a href="javascript:void(0)">
                                    <span>&#xe64f;</span><i>12</i>
                                </a>
                                <a href="javascript:void(0)" class="foc">
                                    <span class="love_a">&#xe639;</span><i class="love_t">26</i>
                                </a>
                            </dd>
                        </dl>
                        <dl>
                            <dt>
                                <a href="com-details.html"><img src="./images/s-images/sp5.png" alt=""></a>
                            </dt>
                            <dd>
                                <p>创意个性餐厅吊灯</p>
                                <a href="javascript:void(0)">
                                    <span>&#xe64f;</span><i>28</i>
                                </a>
                                <a href="javascript:void(0)" class="foc">
                                    <span class="love_a">&#xe639;</span><i class="love_t">47</i>
                                </a>
                            </dd>
                        </dl>
                    </li>
                </ul>
            </div>
        </section>
        <footer>
            <ul class="clearfix">
                <li>
                    <a href="home.html">
                        <span>&#xe645;</span>
                        <i>首页</i>
                    </a>
                </li>
                <li class="active">
                    <a href="script:void(0);">
                        <span>&#xe608;</span>
                        <i>发现</i>
                    </a>
                </li>
                <li>
                    <a href="community.html">
                        <span>&#xe624;</span>
                        <i>社区</i>
                    </a>
                </li>
                <li>
                    <a href="my-entry.html">
                        <span>&#xe647;</span>
                        <i>我的</i>
                    </a>
                </li>
            </ul>
        </footer>
    </div>
    <div class="side-nav" style="display: none;">
        <div class="cover">
            <p>点击此处返回<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAQAAACROWYpAAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAAJdnBBZwAAAB4AAAAeAPhP4T0AAAIzSURBVDjLlZXPS5RRFIafex1QdNKvcaxdUWLBoI26EIaBCoKEYiCcXVALIcIKgvLvmKncOP9AQZsWRbQuJSLIBEsosKKS1AwHRyez8W0xn+B8Pxo9y/Pe51zuOfe+1xASskRxgBVKZit4jQnA4vSRpBPrJirMMc2U+VkHlkOGNOIj7/lFEWijnQRdwCSPzUoorBQXqfCMF2bNU7SFUwxiuW9eBp5RWRU0rJbQLkR1RQVlZf1SVuM6S53QORWU9SZTKuhMPRRAgyooVdMmjenyblAADWtMDuCOI8MGD0OWxnRNh2tSD9gk48KKk+aJ+R2ItjPKMco7c6bMU9KKV3fuY4OJQDTOKM3cMYse4Tmb9FXhXmbM3wC0g9s0kTefvYr5wyxJsLIc5V0AeoBRmsibL4GtmKFTNkIUi+/W6iC3iJAzX0NavowlGsEBih7UcpMIOfM9dF4rgGPZArxPTqzTSCvhUanusQzEPA0Rd1nkhhKhsAMUrSmz7oXBrJJjgevqDoH3U6FkgXkO+VVTIscPRtQTCB9nzmxZ4BUDagjB5xlR0jcLywmmq5fkNY0E1jdr5PnGVXV5hH6amQILpsyE/9Quvk6eNzTV7NvABSb9jrar0PntJ7l3NKnxGjPYA9qjez4bcqWTOh1gb9uq1aDGdxpgrfX2c4klHpnZALSbITpqrddr+q0MMcASU3xggVUsDjES9BKvY/pugTbSJDhCxE1U+MTbXXw3O0pEaGUf+t9H9w8/OdAZo9TXWgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0wMS0yOVQxMTozNjoyOCswODowMI9O+Q4AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTUtMDEtMjlUMTE6MzY6MjgrMDg6MDD+E0GyAAAAAElFTkSuQmCC" alt=""></p>
        </div>
        <div class="nav-container">
            <h2>全部分类</h2>
            <nav>
                <div class="nav-box">
                    <ul>
                        <li class="current"><a href="javascript:void(0)">推荐分类</a></li>
                        <li><a href="javascript:void(0)">卧室</a></li>
                        <li><a href="javascript:void(0)">客厅</a></li>
                        <li><a href="javascript:void(0)">餐厅</a></li>
                        <li><a href="javascript:void(0)">书房</a></li>
                        <li><a href="javascript:void(0)">儿童房</a></li>
                        <li><a href="javascript:void(0)">户外/阳台</a></li>
                        <li><a href="javascript:void(0)">办公家具</a></li>
                        <li><a href="javascript:void(0)">灯饰照明</a></li>
                        <li><a href="javascript:void(0)">厨房用品</a></li>
                        <li><a href="javascript:void(0)">卫浴用品</a></li>
                        <li><a href="javascript:void(0)">墙地面材料</a></li>
                        <li><a href="javascript:void(0)">家装五金</a></li>
                        <li><a href="javascript:void(0)">生活电器</a></li>
                        <li><a href="javascript:void(0)">床上用品</a></li>
                        <li><a href="javascript:void(0)">布衣织物</a></li>
                        <li><a href="javascript:void(0)">家居饰品</a></li>
                        <li><a href="javascript:void(0)">居家日用</a></li>
                        <li><a href="javascript:void(0)">厨房餐饮</a></li>
                    </ul>
                </div>
            </nav>
            <section>
                <div class="item">
                    <ul class="clearfix item-list">
                        <li>
                            <a href="#">
                                <img src="images/shafa.png" alt="">
                                <span>沙发</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </section>
        </div>
    </div>
    <div class="search-page">
        <div class="search-header">
            <a href="javasc:void(0);" class="close-search">&#xe619;</a>
            <form action="" id="search">
                <input type="search" placeholder="搜索商品/店铺">
                <input type="submit">
            </form>
        </div>
        <div class="search-content">
            <div class="search-hot">
                <div class="search-hot-title">
                    <h4><span>&#xe61f;</span>热门搜索</h4>
                </div>
                <div class="search-hot-list">
                    <div class="ht-item">
                        <span>创意小茶几</span>
                    </div>
                    <div class="ht-item">
                        <span>茶桌</span>
                    </div>
                    <div class="ht-item">
                        <span>六屉柜</span>
                    </div>
                    <div class="ht-item">
                        <span>创意小茶几</span>
                    </div>
                    <div class="ht-item">
                        <span>茶桌</span>
                    </div>
                    <div class="ht-item">
                        <span>六屉柜</span>
                    </div>
                    <div class="ht-item">
                        <span>创意小茶几</span>
                    </div>
                    <div class="ht-item">
                        <span>茶桌</span>
                    </div>
                    <div class="ht-item">
                        <span>六屉柜</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="lib/base.js"></script>
    <script type="text/javascript" src="lib/zepto.js"></script>
    <script src="lib/iscroll.js"></script>
    <script type="text/javascript" src="lib/fx.js"></script>
    <script src="lib/echo.js"></script>
    <script src="js/home-data.js"></script>
    <script>
    var myScroll;
    var winWidth = $(window).width();
    $('.nav-container').css({
        'transform': 'translateX(' + (-winWidth + 35) + 'px)',
        'width': winWidth - 35 + 'px'
    });

    $('.home-goods-list a').on('mousedown', function() {
        $('.side-nav').show().children('.nav-container').css({
            transform: 'translateX(0)'
        });
    });
    $('.cover').on('mousedown', function() {
        $('.nav-container').animate({
            transform: 'translateX(' + (-winWidth + 35) + 'px)'
        }, 500, function() {
            $('.side-nav').hide();
        });
    });
    //side-bar toggle
    $('.nav-box ul').on('mousedown', 'li', function(e) {
        $(this).addClass('current').siblings().removeClass('current');
        $('.item-list').html(getHtml(categoryDataList[$(this).index()]))
    });

    //side-bar data
    $('.item-list').html(getHtml(categoryDataList['0']));


    //search module
    $('#search').mousedown(function() {
        $('.search-page').css('display', 'block');
    });
    $('.close-search').on('mousedown', function() {
        $('.search-page').css('display', 'none');
    })

    $('.flow').on('mousedown', '.foc', function() {
        $(this).toggleClass('icc').find('.love_t').text($(this).hasClass('icc') ?
            parseInt($(this).find('.love_t').text()) + 1 :
            parseInt($(this).find('.love_t').text()) - 1);
    });
    //切换数据
    $('.calssify').on('mousedown', 'li', function() {
        $(this).siblings().removeClass('active');
        $(this).addClass('active');
        $('.iScrollVerticalScrollbar.iScrollLoneScrollbar').remove();
        $('.flow li').eq(0).html('<div class="loading">正在加载中...</div>');
        loadFlow();//$(this).find('a').data('url')
        $('.loading').remove();
    });
    loadFlow();
    loaded();

    //图片懒加载
    echo.init({
        offset: 0,
        throttle: 0
    });
    //瀑布流
    function loadFlow(url) {
        url = url || 'other';
        $.get('data/'+url + '.data', function(data) {
            var data = $.parseJSON(data);
            for (var i = 0; i < data.length; i++) {
                var html = '';
                var oDl = $('<dl></dl>');
                html += '<dt><a href="com-details.html"><img src="images/blank.gif" data-echo="' + data[i].img + '" alt=""></a></dt>';
                html += '<dd><p>' + data[i].title + '</p><a href="javascript:void(0)"><span>&#xe64f;</span><i>12</i></a><a href="javascript:void(0)" class="foc"><span class="love_a">&#xe639;</span><i class="love_t">26</i></a></dd>';
                oDl.html(html);
                $('.flow>li').eq(getLiMinHeight()).append(oDl);
            }
        })
        loaded();
    }
    // 导航详细
    function getHtml(data) {
        var html = "";
        for (var i = 0; i < data.length; i++) {
            html += '<li><a href="#"><img src=http://img002.mllres.com/' + data[i].img + ' alt=""><span>' + data[i].name + '</span></a></li>';
        }
        return html;
    }
    //iscroll
    function loaded() {
        setTimeout(function() {
            myScroll = new IScroll('#wrapper', {
                scrollbars: true,
                mouseWheel: true,
                interactiveScrollbars: true,
                shrinkScrollbars: 'scale',
                fadeScrollbars: true,
                preventDefault: false,
            });
            myScroll.on('scrollEnd', function() {
                $('div#scroller').trigger('scroll');
            });
        }, 500)
    }
    // 找到两个li中高度小的一列的index
    function getLiMinHeight() {
        var oLi = $('.flow>li');
        var firstH = oLi.eq(0).offset().height;
        var lastH = oLi.eq(1).offset().height;
        var index = 0;
        return index = firstH < lastH ? 0 : 1;
    }
    </script>
</body>

</html>
